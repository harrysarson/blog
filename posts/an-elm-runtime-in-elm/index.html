<!doctype html><html lang=en itemscope itemtype=http://schema.org/WebPage><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><title>An Elm Runtime in Elm - Harry Sarson's Thoughts</title><meta name=description content="Note  I am writing this post in response to a comment on my last post suggesting that, as a platform-y thing, the elm runtime should be written platform specific code.     The elm runtime must do three things:
  Detect external, asynchronous events.
   Inform the elm application about these detected events by passing it information describing the event.
  Perform actions as requested by the elm application."><script type=application/ld+json>{"@context":"http://schema.org","@type":"WebSite","name":"Harry Sarson\u0027s Thoughts","url":"https:\/\/harrysarson.github.io\/blog\/"}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"Organization","name":"","url":"https:\/\/harrysarson.github.io\/blog\/"}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https:\/\/harrysarson.github.io\/blog\/","name":"home"}},{"@type":"ListItem","position":3,"item":{"@id":"https:\/\/harrysarson.github.io\/blog\/posts\/an-elm-runtime-in-elm\/","name":"An elm runtime in elm"}}]}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"Article","author":{"name":""},"headline":"An Elm Runtime in Elm","description":"Note  I am writing this post in response to a comment on my last post suggesting that, as a platform-y thing, the elm runtime should be written platform specific code.     The elm runtime must do three things:\n  Detect external, asynchronous events.\n   Inform the elm application about these detected events by passing it information describing the event.\n  Perform actions as requested by the elm application.","inLanguage":"en","wordCount":335,"datePublished":"2019-12-09T14:54:31","dateModified":"2019-12-09T14:54:31","image":"https:\/\/harrysarson.github.io\/blog\/","keywords":[""],"mainEntityOfPage":"https:\/\/harrysarson.github.io\/blog\/posts\/an-elm-runtime-in-elm\/","publisher":{"@type":"Organization","name":"https:\/\/harrysarson.github.io\/blog\/","logo":{"@type":"ImageObject","url":"https:\/\/harrysarson.github.io\/blog\/","height":60,"width":60}}}</script><meta property="og:title" content="An Elm Runtime in Elm"><meta property="og:description" content="Note  I am writing this post in response to a comment on my last post suggesting that, as a platform-y thing, the elm runtime should be written platform specific code.     The elm runtime must do three things:
  Detect external, asynchronous events.
   Inform the elm application about these detected events by passing it information describing the event.
  Perform actions as requested by the elm application."><meta property="og:url" content="https://harrysarson.github.io/blog/posts/an-elm-runtime-in-elm/"><meta property="og:type" content="website"><meta property="og:site_name" content="Harry Sarson's Thoughts"><meta name=twitter:title content="An Elm Runtime in Elm"><meta name=twitter:description content="Note  I am writing this post in response to a comment on my last post suggesting that, as a platform-y thing, the elm runtime should be written platform specific code.     The elm runtime must do â€¦"><meta name=twitter:card content="summary"><meta name=generator content="Hugo 0.71.1"><link rel=alternate href=https://harrysarson.github.io/blog/index.xml type=application/rss+xml title="Harry Sarson's Thoughts"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css integrity=sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y crossorigin=anonymous><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.5.0/css/all.css integrity=sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU crossorigin=anonymous><link rel=stylesheet href=https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css integrity=sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u crossorigin=anonymous><link rel=stylesheet href=https://harrysarson.github.io/blog/css/main.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic"><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800"><link rel=stylesheet href=https://harrysarson.github.io/blog/css/syntax.css><link rel=stylesheet href=https://harrysarson.github.io/blog/css/codeblock.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.css integrity=sha384-h/L2W9KefUClHWaty3SLE5F/qvc4djlyR4qY3NUV5HGQBBW7stbcfff1+I/vmsHh crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/default-skin/default-skin.min.css integrity=sha384-iD0dNku6PYSIQLyfTOpB06F2KCZJAKLOThS5HRe8b3ibhdEQ6eKsFf/EeFxdOt5R crossorigin=anonymous></head><body><nav class="navbar navbar-default navbar-fixed-top navbar-custom"><div class=container-fluid><div class=navbar-header><button type=button class=navbar-toggle data-toggle=collapse data-target=#main-navbar>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span><span class=icon-bar></span><span class=icon-bar></span></button>
<a class=navbar-brand href=https://harrysarson.github.io/blog/>Harry Sarson's Thoughts</a></div><div class="collapse navbar-collapse" id=main-navbar><ul class="nav navbar-nav navbar-right"></ul></div></div></nav><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><header class=header-section><div class="intro-header no-img"><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class=posts-heading><h1>An Elm Runtime in Elm</h1><hr class=small></div></div></div></div></div></header><div class=container role=main><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><article role=main class=blog-post><div class="admonitionblock note"><table><tr><td class=icon><div class=title>Note</div></td><td class=content>I am writing this post in response to a comment on my <a href=../why-platform-must-define-task>last post</a> suggesting that, as a platform-y thing, the elm runtime should be written platform specific code.</td></tr></table></div><div class=paragraph><p>The elm runtime must do three things:</p></div><div class="olist arabic"><ol class=arabic><li><p>Detect external, asynchronous events.</p></li><li><p><a id=inform-elm-app></a>Inform the elm application about these detected events by passing it information describing the event.</p></li><li><p>Perform actions as requested by the elm application.</p></li></ol></div><div class=paragraph><p>In response to the runtime, the elm application must</p></div><div class="olist arabic"><ol class=arabic><li><p>Update its state.</p></li><li><p>Instruct the runtime to perform actions.</p></li><li><p>Inform the runtime about which asynchronous events it should be detecting.</p></li></ol></div><div class=paragraph><p>The diagram below summarises these interactions.
My claim is that most of the work done by the elm runtime consists of piping data between the various components.
I have marked in blue ink all the routes that the runtime passes data along.</p></div><div class=imageblock><div class=content><img src=../../images/elm-runtime.jpg alt="The elm runtime in diagram form"></div></div><div class=paragraph><p>Currently, only the <code>APP</code> and <code>EVENT MANAGER</code> <sup class=footnote>[<a id=_footnoteref_1 class=footnote href=#_footnotedef_1 title="View footnote.">1</a>]</sup> components are written in elm.
My hope is to write the <code>MANAGE STATE</code> component in elm too.</p></div><div class=paragraph><p>The runtime must use kernel code to interact with the world (detecting events and performing actions) though use of non-pure functions.
The rest of the elm runtime manipulates data&#8201;&#8212;&#8201;this is the most complex and bug prone part but can be implemented using pure functions.
Writing this part of the runtime in elm will decrease the labour of porting elm to a new target and, by utilising the type system <sup class=footnote>[<a id=_footnoteref_2 class=footnote href=#_footnotedef_2 title="View footnote.">2</a>]</sup>, will lead to a correct and robust elm runtime.</p></div><div class=paragraph><p>Harry.</p></div><div id=footnotes><hr><div class=footnote id=_footnotedef_1><a href=#_footnoteref_1>1</a>. Event managers require special elm syntax only available to core components.</div><div class=footnote id=_footnotedef_2><a href=#_footnoteref_2>2</a>. The rules of elm type system are too restrictive so we will have to play some tricks (using kernel code) to bypass some of the security that the runtime provides. We can still use type checking to our advantage for the majority of the code we will write. If the compiler checks the majority of our code for us, we can focus our energy and our time on reviewing and documenting the minority code that breaks the rules. More on this later.</div></div></article><ul class="pager blog-pager"><li class=previous><a href=https://harrysarson.github.io/blog/posts/why-platform-must-define-task/ data-toggle=tooltip data-placement=top title="Why Platform Must Define Task">&larr; Previous Post</a></li><li class=next><a href=https://harrysarson.github.io/blog/posts/effect-modules/ data-toggle=tooltip data-placement=top title="Effect modules in elm">Next Post &rarr;</a></li></ul></div></div></div><footer><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center footer-links"></ul><p class="credits copyright text-muted">&nbsp;&bull;&nbsp;&copy;
2020
&nbsp;&bull;&nbsp;
<a href=https://harrysarson.github.io/blog/>Harry Sarson's Thoughts</a></p><p class="credits theme-by text-muted"><a href=https://gohugo.io>Hugo v0.71.1</a> powered &nbsp;&bull;&nbsp; Theme <a href=https://github.com/halogenica/beautifulhugo>Beautiful Hugo</a> adapted from <a href=https://deanattali.com/beautiful-jekyll/>Beautiful Jekyll</a></p></div></div></div></footer><script src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.js integrity=sha384-K3vbOmF2BtaVai+Qk37uypf7VrgBubhQreNQe9aGsz9lB63dIFiQVlJbr92dw2Lx crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/contrib/auto-render.min.js integrity=sha384-kmZOZB5ObwgQnS/DuDg6TScgOiWWBiVt0plIRkZCmE6rDZGrEOQeHM5PcHi+nyqe crossorigin=anonymous></script><script src=https://code.jquery.com/jquery-1.12.4.min.js integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin=anonymous></script><script src=https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js integrity=sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa crossorigin=anonymous></script><script src=https://harrysarson.github.io/blog/js/main.js></script><script>renderMathInElement(document.body);</script><script src=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.js integrity=sha384-QELNnmcmU8IR9ZAykt67vGr9/rZJdHbiWi64V88fCPaOohUlHCqUD/unNN0BXSqy crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe-ui-default.min.js integrity=sha384-m67o7SkQ1ALzKZIFh4CiTA8tmadaujiTa9Vu+nqPSwDOqHrDmxLezTdFln8077+q crossorigin=anonymous></script><script src=https://harrysarson.github.io/blog/js/load-photoswipe.js></script></body></html>